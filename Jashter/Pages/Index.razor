@page "/"
@inject HttpClient _http
@using Jashter.Shared.Dto

<PageTitle>Index</PageTitle>

<h1>Hello, world!</h1>
<div>@_statusCode</div>

Welcome to your new app.

<SurveyPrompt Title="How is Blazor working for you?" />
@code{
    private string _statusCode = "";
    protected override async Task OnInitializedAsync()
    {
        LoginDto loginDto = new LoginDto { Username = "test1", Password = "pas" };
        HttpRequestMessage request = new HttpRequestMessage(HttpMethod.Post, new Uri("https://www.sato-home.mydns.jp:8443/api/login"));
        request.Headers.Add("Access-Control-Allow-Origin", "http://localhost:5058");
        request.Content = new StringContent(System.Text.Json.JsonSerializer.Serialize(loginDto), System.Text.Encoding.UTF8, "application/json");
        var reponse = await _http.SendAsync(request);
        LoginResponseDto loginResponseDto = await reponse.Content.ReadFromJsonAsync<LoginResponseDto>();
        _statusCode = loginResponseDto.StatusCode;
        StateHasChanged();
    }
}